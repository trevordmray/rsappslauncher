<!DOCTYPE html>
<!-- The `class` attribute is left empty so JavaScript can add 'dark' to it -->
<html lang="en" class="">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RealSource App Portal</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <!-- Google Fonts: Inter for body, Lexend for headers -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Lexend:wght@600&display=swap" rel="stylesheet">
    <style>
        /* Apply the Inter font globally */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom font for the main header title */
        .header-title {
            font-family: 'Lexend', sans-serif;
        }
        /* Custom scrollbar for a cleaner look */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-thumb {
            background-color: #94a3b8; /* Slate 400 */
            border-radius: 4px;
        }
        /* New scrollbar style for dark mode */
        .dark ::-webkit-scrollbar-thumb {
            background-color: #475569; /* Slate 600 */
        }
    </style>
    <script>
        // Configure Tailwind CSS
        tailwind.config = {
            // Enable Tailwind's class-based dark mode strategy
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        'primary-blue': '#0078D4',
                        'dark-text': '#1f2937',
                    }
                }
            }
        }
    </script>
</head>
<!-- Set background and text colors for light/dark modes -->
<body class="bg-gray-50 dark:bg-gray-900 text-gray-800 dark:text-gray-300 min-h-screen transition-colors duration-300">

    <!-- Main content container with padding to avoid overlap with the fixed footer -->
    <main class="p-4 sm:p-8 pb-24">
        <!-- Header Section -->
        <header class="max-w-4xl mx-auto mb-10 text-center">
            <!-- Company Logo (swaps for dark mode) -->
            <img src="https://raw.githubusercontent.com/trevordmray/rsappslauncher/main/realsourcelogo.png" alt="RealSource Logo" class="mx-auto h-24 w-auto mb-4 block dark:hidden">
            <img src="https://raw.githubusercontent.com/trevordmray/rsappslauncher/main/realsourcelogorev.png" alt="RealSource Logo" class="mx-auto h-24 w-auto mb-4 hidden dark:block">
            
            <h1 class="header-title text-4xl font-semibold bg-clip-text text-transparent bg-gradient-to-r from-primary-blue to-sky-500 mt-6 mb-2">
                Application Hub
            </h1>
            <p class="text-lg text-gray-500 dark:text-gray-400">
                Quickly access your RealSource tools and resources.
            </p>
        </header>

        <!-- Application Grid -->
        <div class="max-w-5xl mx-auto grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6" id="appGrid">
            <!-- App tiles will be dynamically inserted here by JavaScript -->
        </div>

        <!-- Security Disclaimer -->
        <footer class="max-w-4xl mx-auto mt-12 text-center">
            <p class="text-xs text-gray-400 dark:text-gray-500 leading-relaxed">
                This portal and its contents are the exclusive property of RealSource Properties and are intended for authorized employees only. Unauthorized access, use, or distribution of any information contained within this system is strictly prohibited and may result in legal action. By proceeding, you acknowledge and agree to abide by all company policies regarding the use of internal systems and confidential data. If you are not an authorized user, you must exit this portal immediately.
            </p>
        </footer>
    </main>
    
    <!-- Sticky Footer Bar for UI Controls -->
    <div class="fixed bottom-0 left-0 w-full p-2 sm:p-4 bg-gray-100/90 dark:bg-gray-900/90 backdrop-blur-sm border-t border-gray-200 dark:border-gray-700 z-40">
        <div class="max-w-5xl mx-auto flex justify-between items-center">
            <!-- Dark Mode Toggle Button -->
            <button id="theme-toggle" type="button" class="text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700 focus:outline-none focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-700 rounded-lg text-sm px-4 py-2.5 transition flex items-center gap-x-2 font-medium">
                <svg id="theme-toggle-light-icon" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm-.707 10.607a1 1 0 011.414 0l.707-.707a1 1 0 111.414 1.414l-.707.707a1 1 0 01-1.414 0zM2 11a1 1 0 100-2H1a1 1 0 100 2h1z" fill-rule="evenodd" clip-rule="evenodd"></path></svg>
                <svg id="theme-toggle-dark-icon" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg>
                <span id="theme-toggle-text"></span>
            </button>

            <!-- Credits Button -->
            <button id="credits-button" class="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-blue">
                <i class="fas fa-info-circle text-gray-500 dark:text-gray-400 text-2xl"></i>
            </button>
        </div>
    </div>


    <!-- MODALS -->

    <!-- Welcome Modal -->
    <div id="welcomeModal" class="fixed inset-0 bg-gray-900 bg-opacity-70 flex items-center justify-center p-4 z-50 hidden transition-opacity duration-300 ease-out opacity-0">
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-lg p-6 md:p-8 transform transition-transform duration-300 ease-out scale-95">
            <div class="flex justify-between items-start mb-4">
                <h2 class="text-2xl font-bold text-dark-text dark:text-white">Welcome! Important Changes</h2>
                 <button id="welcome-close-button-x" class="text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 transition">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <p class="text-base text-gray-700 dark:text-gray-300 mb-6">
                theRAP and Single Sign On (SSO) have been discontinued. You can read more about this change <a href="https://realsource451.sharepoint.com/:w:/g/EZGWxPx5pGVJqIhXIhDQvGQBEjbzLIbZvLmAdjn1O80qhw?e=KLxqXz" target="_blank" class="text-primary-blue font-semibold hover:underline">here</a>.
            </p>
            <div class="flex items-center mb-6">
                <input id="dontShowAgain" type="checkbox" class="h-4 w-4 text-primary-blue focus:ring-primary-blue border-gray-300 dark:border-gray-600 rounded">
                <label for="dontShowAgain" class="ml-2 block text-sm text-gray-900 dark:text-gray-300">Don't show this again for 24 hours</label>
            </div>
            <button id="welcome-close-button" class="w-full mt-3 px-6 py-3 text-base font-medium rounded-lg text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 focus:outline-none transition-all duration-150 ease-in-out">Close</button>
        </div>
    </div>


    <!-- App Instructions Modal -->
    <div id="appModal" class="fixed inset-0 bg-gray-900 bg-opacity-70 flex items-center justify-center p-4 z-50 hidden transition-opacity duration-300 ease-out opacity-0">
        <div id="appModalContent" class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-lg p-6 md:p-8 transform transition-transform duration-300 ease-out scale-95">
            <div class="flex justify-between items-start mb-4">
                <h2 id="modalTitle" class="text-2xl font-bold text-dark-text dark:text-white"></h2>
                <button data-modal-hide="appModal" class="text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 transition">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div id="instructionBox" class="p-4 rounded-lg mb-6">
                <p id="modalInstructions" class="text-base"></p>
            </div>
            <a id="modalLink" class="w-full inline-flex justify-center items-center px-6 py-3 border border-transparent text-base font-medium rounded-lg text-white bg-primary-blue hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-blue transition-all duration-150 ease-in-out" target="_blank">Continue to Application</a>
            <button data-modal-hide="appModal" id="modalCloseBtn" class="w-full mt-3 px-6 py-3 text-base font-medium rounded-lg text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 focus:outline-none transition-all duration-150 ease-in-out">Understood / Close</button>
        </div>
    </div>

    <!-- Credits Modal -->
    <div id="creditsModal" class="fixed inset-0 bg-gray-900 bg-opacity-70 flex items-center justify-center p-4 z-50 hidden transition-opacity duration-300 ease-out opacity-0">
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-lg p-6 md:p-8 transform transition-transform duration-300 ease-out scale-95">
            <div class="flex justify-between items-start mb-4">
                <h2 class="text-2xl font-bold text-dark-text dark:text-white">Credits & Acknowledgements</h2>
                <button data-modal-hide="creditsModal" class="text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 transition">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <p class="text-base text-gray-700 dark:text-gray-300 mb-6">Portal created and designed by <strong>Trevor Ray</strong> for <strong>RealSource Properties</strong>.</p>
            <h3 class="text-lg font-semibold text-dark-text dark:text-white mb-3">Open Source Acknowledgements:</h3>
            <ul class="list-disc list-inside text-gray-600 dark:text-gray-400 space-y-2">
                <li><strong>Tailwind CSS:</strong> A utility-first CSS framework for rapid UI development.</li>
                <li><strong>Font Awesome:</strong> The web's most popular icon set and toolkit.</li>
                <li><strong>Google Fonts (Lexend & Inter):</strong> High-quality, open-source fonts for the web.</li>
            </ul>
            <button data-modal-hide="creditsModal" class="w-full mt-8 px-6 py-3 text-base font-medium rounded-lg text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 focus:outline-none transition-all duration-150 ease-in-out">Close</button>
        </div>
    </div>

    <script>
        // Wait for the DOM to be fully loaded before running any scripts
        document.addEventListener('DOMContentLoaded', () => {

            // --- 1. DATA & CONSTANTS ---
            const apps = [
                { name: "Entrata", icon: "fa-solid fa-building", link: "https://realsourcemgmt.entrata.com/", instructions: "Log in using your **Alias and password** (Use \"Reset Password\" to get a new password after SSO phase out)<br><br>Example for Jane Doe:<br>Username: **jdoe**<br>Password: (enter known password or reset password using email)" },
                { name: "Outlook", icon: "fa-solid fa-envelope", link: "https://outlook.office.com", instructions: "To log in, use your **RealSource Outlook Email and Password**" },
                { name: "Teams", icon: "fa-solid fa-comments", link: "https://teams.microsoft.com/v2/", instructions: "To log in, use your **RealSource Outlook Email and Password**" },
                { name: "Inflection/Time Clock", icon: "fa-solid fa-clock", link: "https://secure3.yourpayrollhr.com/ta/IHR0762.clock", instructions: "Log in using your **Alias and password** (Check email for initial password after SSO phase out)<br><br>Example for Jane Doe:<br>Username: **jdoe**<br>Password: (enter known password or initial password from email)" },
                { name: "SharePoint", icon: "fa-brands fa-microsoft", link: "https://realsource451.sharepoint.com/", instructions: "To log in, use your **RealSource Outlook Email and Password**" },
                { name: "EliseAI", icon: "fa-solid fa-robot", link: "https://app.meetelise.com", instructions: "Log in using your **Alias and password** (Use \"Reset Password\" to get a new password after SSO phase out)" },
                { name: "Motivosity", icon: "fa-solid fa-gift", link: "https://www.motivosity.com/", instructions: "Enter **Alias Email (Alias@realsource.net)** and Enter Password. (Use Reset password after SSO Phase Out). (You may also request a one time code for login)." },
                { name: "Concur Expense", icon: "fa-solid fa-credit-card", link: "https://www.concursolutions.com/", instructions: "Use **RealSource Email and Concur password** (Use Reset password after SSO Phase Out)" },
                { name: "LRO", icon: "fa-solid fa-chart-line", link: "https://ao.realpage.com/ysconfig/app/login?authfailed=true", instructions: "Use **email and password** (Unchanged after SSO Phase Out)" },
                { name: "DocuVerus", icon: "fa-solid fa-file-signature", link: "https://app.dvapply.com./ats/login", instructions: "Use **email and password** (Unchanged after SSO Phase Out)" },
                { name: "Reputation", icon: "fa-solid fa-globe", link: "https://app.reputation.com/auth", instructions: "Use **email and password** (Unchanged after SSO Phase Out)" },
                { name: "theRAP Forms", icon: "fa-solid fa-file", link: "https://realsource451.sharepoint.com/:f:/g/EtThzHeloH9Hqwl6ik0A3OUB9KBc0hBGIPicJ3Vrf-fyEg?e=TYFeyq", instructions: "Forms normally found in theRAP have been moved to SharePoint. If you are unable to find a form you need, please submit an IT ticket" },
                { name: "Support", icon: "fa-solid fa-headset", link: "https://realsource.freshdesk.com", instructions: "Enter a ticket on **Freshdesk** for all support requests." },
                { name: "GraceHill", icon: "fa-solid fa-book", link: "", instructions: "**Discontinued** after SSO Phase Out - Employees will no longer need to log into this system", disabled: true },
            ];
            const WELCOME_DISMISS_KEY = 'welcomeDismissed';

            // --- 2. DOM ELEMENT SELECTIONS ---
            const root = document.documentElement;
            const appGrid = document.getElementById("appGrid");
            
            // Buttons
            const themeToggleBtn = document.getElementById('theme-toggle');
            const creditsBtn = document.getElementById("credits-button");

            // Theme UI elements
            const themeToggleLightIcon = document.getElementById('theme-toggle-light-icon');
            const themeToggleDarkIcon = document.getElementById('theme-toggle-dark-icon');
            const themeToggleText = document.getElementById('theme-toggle-text');
            
            // Modals
            const welcomeModal = document.getElementById("welcomeModal");
            const appModal = document.getElementById("appModal");
            const creditsModal = document.getElementById("creditsModal");
            
            // App Modal Content
            const modalTitle = document.getElementById("modalTitle");
            const modalInstructions = document.getElementById("modalInstructions");
            const modalLink = document.getElementById("modalLink");
            const modalCloseBtn = document.getElementById("modalCloseBtn");
            const instructionBox = document.getElementById("instructionBox");


            // --- 3. FUNCTIONS ---

            // --- Modal Management ---
            const showModal = (modalElement) => {
                if (!modalElement) return;
                modalElement.classList.remove('hidden');
                setTimeout(() => modalElement.classList.remove('opacity-0'), 10);
            };

            const hideModal = (modalElement) => {
                if (!modalElement) return;
                modalElement.classList.add('opacity-0');
                setTimeout(() => modalElement.classList.add('hidden'), 300);
            };
            
            const handleWelcomeModalClose = () => {
                const dontShowAgain = document.getElementById('dontShowAgain').checked;
                if (dontShowAgain) {
                    const expiry = new Date().getTime() + (24 * 60 * 60 * 1000); // 24 hours
                    localStorage.setItem(WELCOME_DISMISS_KEY, expiry);
                }
                hideModal(welcomeModal);
            };

            const checkWelcomeModal = () => {
                const dismissedUntil = localStorage.getItem(WELCOME_DISMISS_KEY);
                if (!dismissedUntil || new Date().getTime() > dismissedUntil) {
                    showModal(welcomeModal);
                }
            };

            const showAppInfoModal = (app) => {
                modalTitle.innerHTML = app.name;
                modalInstructions.innerHTML = app.instructions.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
                instructionBox.className = 'p-4 rounded-lg mb-6'; // Reset classes
                modalInstructions.className = 'text-base';

                if (app.disabled || !app.link) {
                    modalLink.classList.add('hidden');
                    modalCloseBtn.textContent = "Understood / Close";
                    instructionBox.classList.add('bg-red-50', 'dark:bg-red-900/20', 'border-l-4', 'border-red-500', 'dark:border-red-600');
                    modalInstructions.classList.add('text-red-900', 'dark:text-red-300');
                } else {
                    modalLink.classList.remove('hidden');
                    modalLink.href = app.link;
                    modalCloseBtn.textContent = "Not now";
                    instructionBox.classList.add('bg-yellow-50', 'dark:bg-yellow-900/20', 'border-l-4', 'border-yellow-500', 'dark:border-yellow-600');
                    modalInstructions.classList.add('text-yellow-900', 'dark:text-yellow-300');
                }
                showModal(appModal);
            };


            // --- Theme Management ---
            const updateThemeUI = (isDark) => {
                themeToggleDarkIcon.classList.toggle('hidden', !isDark);
                themeToggleLightIcon.classList.toggle('hidden', isDark);
                themeToggleText.textContent = isDark ? 'Toggle Light Mode' : 'Toggle Dark Mode';
            };
            
            const applyTheme = (isDark) => {
                root.classList.toggle('dark', isDark);
                updateThemeUI(isDark);
            };

            const initializeTheme = () => {
                const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                applyTheme(prefersDark);
            };

            // --- App Tile Rendering ---
            const renderAppTiles = () => {
                appGrid.innerHTML = ''; // Clear grid before rendering
                apps.forEach(app => {
                    const tile = document.createElement("a");
                    const tileClasses = app.disabled ? "opacity-50 cursor-not-allowed bg-gray-100 dark:bg-gray-800 dark:text-gray-400 hover:bg-gray-100 hover:transform-none" : "group hover:-translate-y-1 hover:bg-blue-50 dark:hover:bg-gray-700";
                    
                    tile.className = `p-6 flex flex-col items-center justify-center bg-white dark:bg-gray-800 rounded-xl shadow-md transition-all duration-300 ease-in-out cursor-pointer hover:shadow-lg ${tileClasses}`;
                    tile.href = "#";
                    tile.innerHTML = `<i class="${app.icon} text-4xl text-primary-blue mb-4 transition-all duration-300"></i><h3 class="text-lg font-semibold text-dark-text dark:text-gray-200 text-center transition-all duration-300">${app.name}</h3>`;
                    
                    tile.addEventListener('click', (e) => {
                        e.preventDefault();
                        showAppInfoModal(app);
                    });

                    appGrid.appendChild(tile);
                });
            };

            // --- 4. EVENT LISTENER SETUP ---
            const setupEventListeners = () => {
                // Theme toggle
                themeToggleBtn.addEventListener('click', () => {
                    applyTheme(!root.classList.contains('dark'));
                });

                // Credits button
                creditsBtn.addEventListener('click', () => showModal(creditsModal));
                
                // Welcome modal close buttons
                document.getElementById('welcome-close-button').addEventListener('click', handleWelcomeModalClose);
                document.getElementById('welcome-close-button-x').addEventListener('click', handleWelcomeModalClose);

                // Generic modal close buttons (using data attributes)
                document.querySelectorAll('[data-modal-hide]').forEach(button => {
                    const modalId = button.getAttribute('data-modal-hide');
                    const modalEl = document.getElementById(modalId);
                    if (modalEl) {
                        button.addEventListener('click', () => hideModal(modalEl));
                    }
                });

                // Close modals by clicking on the backdrop
                [welcomeModal, appModal, creditsModal].forEach(modalEl => {
                    modalEl.addEventListener('click', (event) => {
                        if (event.target === modalEl) {
                            // For welcome modal, use its specific close logic
                            if (modalEl.id === 'welcomeModal') {
                                handleWelcomeModalClose();
                            } else {
                                hideModal(modalEl);
                            }
                        }
                    });
                });

                // Listen for OS theme changes
                window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
                    // Always update based on OS theme changes.
                    applyTheme(event.matches);
                });
            };

            // --- 5. INITIALIZATION ---
            const init = () => {
                renderAppTiles();
                initializeTheme();
                checkWelcomeModal();
                setupEventListeners();
            };

            // Run the application
            init();
        });
    </script>

</body>
</html>

